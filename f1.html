<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>F1 Data Visualizer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6; /* bg-gray-100 */
        }
        .loader {
            border: 8px solid #e5e7eb; /* border-gray-200 */
            border-radius: 50%;
            border-top: 8px solid #ef4444; /* border-red-500 */
            width: 60px;
            height: 60px;
            animation: spin 1.5s linear infinite;
            margin: 4rem auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .collapsible {
            cursor: pointer;
            border-bottom: 1px solid #e2e8f0;
            transition: background-color 0.2s ease-in-out;
        }
        .collapsible:hover {
            background-color: #f9fafb; /* bg-gray-50 */
        }
        .content {
            display: none;
            overflow: hidden;
            padding-top: 1rem;
        }
        /* Style for Plotly chart */
        .plotly .modebar {
            display: none !important;
        }
    </style>
</head>
<body class="text-gray-800">

    <div class="container mx-auto p-4 md:p-8">
        <header class="text-center mb-8">
            <h1 class="text-4xl font-bold text-red-600">F1 Data Visualizer</h1>
            <p class="text-lg text-gray-600">Explore Formula 1 data across different seasons and races.</p>
        </header>

        <!-- Controls -->
        <div class="bg-white p-6 rounded-lg shadow-md mb-8">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                <div>
                    <label for="year-select" class="block text-sm font-medium text-gray-700">Select Year:</label>
                    <select id="year-select" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-red-500 focus:border-red-500 sm:text-sm rounded-md"></select>
                </div>
                <div>
                    <label for="race-select" class="block text-sm font-medium text-gray-700">Select Race:</label>
                    <select id="race-select" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-red-500 focus:border-red-500 sm:text-sm rounded-md"></select>
                </div>
                <div class="md:col-span-2 flex items-end">
                    <button id="fetch-data-btn" class="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-md transition duration-300">
                        Visualize Race Data
                    </button>
                </div>
            </div>
            <div id="error-message" class="mt-4 text-red-600 text-center font-medium"></div>
        </div>
        
        <div id="loader" class="loader hidden"></div>

        <!-- Data Display Area -->
        <div id="data-container" class="space-y-6 hidden">
            <!-- Event Schedule -->
            <div id="schedule-section" class="bg-white p-6 rounded-lg shadow-md">
                <h2 class="collapsible text-2xl font-semibold mb-4 flex justify-between items-center">Event Information <span>&#9660;</span></h2>
                <div class="content">
                    <div id="schedule-details" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
                </div>
            </div>

            <!-- Race Results -->
            <div id="results-section" class="bg-white p-6 rounded-lg shadow-md">
                <h2 class="collapsible text-2xl font-semibold mb-4 flex justify-between items-center">Race Results <span>&#9660;</span></h2>
                <div class="content">
                    <div class="overflow-x-auto">
                        <table id="results-table" class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50"></thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- Driver Performance & Comparison -->
            <div id="driver-analysis-section" class="bg-white p-6 rounded-lg shadow-md">
                 <h2 class="collapsible text-2xl font-semibold mb-4 flex justify-between items-center">Driver Performance Analysis <span>&#9660;</span></h2>
                 <div class="content">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                        <div>
                            <label for="driver1-select" class="block text-sm font-medium text-gray-700">Select Driver:</label>
                            <select id="driver1-select" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-red-500 focus:border-red-500 sm:text-sm rounded-md"></select>
                        </div>
                        <div>
                            <label for="driver2-select" class="block text-sm font-medium text-gray-700">Compare With:</label>
                            <select id="driver2-select" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-red-500 focus:border-red-500 sm:text-sm rounded-md"></select>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        <div>
                            <h3 id="driver-lap-by-lap-title" class="text-lg font-semibold mb-2">Lap-by-Lap Performance</h3>
                            <div id="driver-lap-by-lap-table" class="max-h-96 overflow-y-auto"></div>
                        </div>
                        <div>
                            <h3 class="text-lg font-semibold mb-2">Fastest Lap: Corner Speed Comparison</h3>
                            <div id="corner-comparison-chart"></div>
                        </div>
                    </div>
                 </div>
            </div>

            <!-- Detailed Telemetry -->
            <div id="telemetry-section" class="bg-white p-6 rounded-lg shadow-md">
                <h2 id="telemetry-title" class="collapsible text-2xl font-semibold mb-4 flex justify-between items-center">Fastest Lap Telemetry <span>&#9660;</span></h2>
                <div class="content">
                    <div id="telemetry-chart"></div>
                </div>
            </div>

            <!-- Lap Times -->
            <div id="laps-section" class="bg-white p-6 rounded-lg shadow-md">
                <h2 class="collapsible text-2xl font-semibold mb-4 flex justify-between items-center">Lap Times Analysis (All Drivers) <span>&#9660;</span></h2>
                <div class="content">
                    <div id="lap-times-chart"></div>
                </div>
            </div>
            
            <!-- Pit Stops & Tyre Data -->
            <div id="pitstops-section" class="bg-white p-6 rounded-lg shadow-md">
                <h2 class="collapsible text-2xl font-semibold mb-4 flex justify-between items-center">Pit Stops & Tyre Strategy <span>&#9660;</span></h2>
                <div class="content">
                     <div class="overflow-x-auto">
                        <table id="pitstops-table" class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50"></thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- MOCK DATABASE ---
        // This mock data is expanded to reflect the rich data available from the FastF1 library.
        const driverList = ["VER", "PER", "HAM", "RUS", "LEC", "SAI", "NOR", "PIA", "ALO", "STR", "GAS", "OCO", "MAG", "HUL", "TSU", "RIC", "BOT", "ZHO", "ALB", "SAR"];

        const generateRandomLapData = (baseTime, numLaps) => {
            let laps = [];
            for (let i = 1; i <= numLaps; i++) {
                laps.push({
                    lap: i,
                    time: baseTime + Math.random() * 1.5 - 0.75,
                    position: Math.floor(Math.random() * 20) + 1,
                    compound: i < numLaps / 2 ? 'Medium' : 'Hard'
                });
            }
            return laps;
        };

        const generateCornerData = (baseSpeed) => {
            let corners = [];
            for (let i = 1; i <= 18; i++) { // Assuming 18 corners
                corners.push({
                    corner: i,
                    speed: baseSpeed + Math.random() * 20 - 10
                });
            }
            return corners;
        }

        const mockDatabase = {
            "2025": {
                "Bahrain Grand Prix": {
                    schedule: { raceName: "Bahrain Grand Prix", circuitName: "Bahrain International Circuit", locality: "Sakhir", country: "Bahrain", date: "2025-03-16", time: "15:00:00Z" },
                    results: driverList.map((d, i) => ({ position: `${i + 1}`, Driver: { code: d, givenName: d, familyName: "" }, Constructor: { name: "Team " + String.fromCharCode(65 + Math.floor(i/2)) }, laps: "57", Time: { time: `+${i * 2.5}s` }, status: "Finished", points: `${Math.max(0, 25 - i*2)}` })),
                    pitStops: driverList.slice(0, 10).map(d => ({ driverId: d, lap: Math.floor(20 + Math.random() * 10), stop: "1", duration: (22 + Math.random() * 2).toFixed(1), compound: "Hard", tyreAge: 25 })),
                    lapData: Object.fromEntries(driverList.map((d, i) => [d, generateRandomLapData(92 + i*0.1, 57)])),
                    cornerData: Object.fromEntries(driverList.map((d, i) => [d, generateCornerData(150 - i*2)]))
                }
            },
            "2023": {
                "Italian Grand Prix": {
                    schedule: { raceName: "Italian Grand Prix", circuitName: "Monza", locality: "Monza", country: "Italy", date: "2023-09-03", time: "13:00:00Z" },
                    results: driverList.map((d, i) => ({ position: `${i + 1}`, Driver: { code: d, givenName: d, familyName: "" }, Constructor: { name: "Team " + String.fromCharCode(65 + Math.floor(i/2)) }, laps: "51", Time: { time: `+${i * 1.5}s` }, status: "Finished", points: `${Math.max(0, 25 - i*2)}` })),
                    pitStops: driverList.slice(0, 15).map(d => ({ driverId: d, lap: Math.floor(20 + Math.random() * 5), stop: "1", duration: (21 + Math.random() * 2).toFixed(1), compound: "Hard", tyreAge: 22 })),
                    lapData: Object.fromEntries(driverList.map((d, i) => [d, generateRandomLapData(83 + i*0.05, 51)])),
                    cornerData: Object.fromEntries(driverList.map((d, i) => [d, generateCornerData(180 - i*2)])),
                    telemetry: {
                        driver: "VER",
                        distance: Array.from({length: 100}, (_, i) => i * 58),
                        speed: Array.from({length: 100}, (_, i) => 150 + 180 * Math.sin(i / 10) * Math.cos(i / 25)),
                        rpm: Array.from({length: 100}, (_, i) => 9500 + 2500 * Math.sin(i / 10) * Math.cos(i / 25)),
                        gear: Array.from({length: 100}, (_, i) => Math.round(5 + 3 * Math.sin(i / 10) * Math.cos(i / 25))),
                        throttle: Array.from({length: 100}, (_, i) => Math.max(0, 100 * Math.sin(i/10))),
                        brake: Array.from({length: 100}, (_, i) => Math.abs(i % 20 - 10) < 2 ? 100 : 0)
                    }
                }
            }
        };

        document.addEventListener('DOMContentLoaded', () => {
            const yearSelect = document.getElementById('year-select');
            const raceSelect = document.getElementById('race-select');
            const fetchDataBtn = document.getElementById('fetch-data-btn');
            const loader = document.getElementById('loader');
            const dataContainer = document.getElementById('data-container');
            const errorMessage = document.getElementById('error-message');
            const driver1Select = document.getElementById('driver1-select');
            const driver2Select = document.getElementById('driver2-select');

            const availableYears = Object.keys(mockDatabase).sort((a, b) => b - a);
            availableYears.forEach(year => {
                const option = document.createElement('option');
                option.value = year;
                option.textContent = year;
                yearSelect.appendChild(option);
            });

            const populateRaces = () => {
                const year = yearSelect.value;
                const races = mockDatabase[year] ? Object.keys(mockDatabase[year]) : [];
                raceSelect.innerHTML = '';
                races.forEach(raceName => {
                    const option = document.createElement('option');
                    option.value = raceName;
                    option.textContent = raceName;
                    raceSelect.appendChild(option);
                });
            };

            const populateDriverSelects = (drivers) => {
                [driver1Select, driver2Select].forEach(select => {
                    select.innerHTML = '';
                    drivers.forEach((driver, index) => {
                        const option = document.createElement('option');
                        option.value = driver.code;
                        option.textContent = `${driver.givenName} ${driver.familyName || ''} (${driver.code})`;
                        select.appendChild(option);
                    });
                });
                driver2Select.selectedIndex = 1; // Default to comparing with the second driver
            };
            
            const updateDriverAnalysis = () => {
                const year = yearSelect.value;
                const raceName = raceSelect.value;
                const raceData = mockDatabase[year]?.[raceName];
                if (!raceData) return;

                const driver1 = driver1Select.value;
                const driver2 = driver2Select.value;
                
                renderDriverPerformanceTable(raceData.lapData[driver1], driver1);
                renderComparisonChart(raceData.cornerData[driver1], raceData.cornerData[driver2], driver1, driver2);
            };

            yearSelect.addEventListener('change', populateRaces);
            driver1Select.addEventListener('change', updateDriverAnalysis);
            driver2Select.addEventListener('change', updateDriverAnalysis);
            
            populateRaces();
            setupCollapsibles();

            fetchDataBtn.addEventListener('click', () => {
                const year = yearSelect.value;
                const raceName = raceSelect.value;
                const raceData = mockDatabase[year]?.[raceName];

                loader.classList.remove('hidden');
                dataContainer.classList.add('hidden');
                errorMessage.textContent = '';

                setTimeout(() => {
                    if (raceData) {
                        populateDriverSelects(raceData.results.map(r => r.Driver));
                        renderAll(raceData);
                        dataContainer.classList.remove('hidden');
                    } else {
                        errorMessage.textContent = 'Sorry, data is not available for the selected race.';
                    }
                    loader.classList.add('hidden');
                }, 1000);
            });
            
            const renderAll = (data) => {
                renderSchedule(data.schedule);
                renderResults(data.results);
                if (data.telemetry) renderTelemetry(data.telemetry);
                renderLapTimes(data.lapData, data.schedule.raceName);
                renderPitStops(data.pitStops);
                updateDriverAnalysis();
                document.querySelectorAll('.content').forEach(el => el.style.display = 'block');
                document.querySelectorAll('.collapsible span').forEach(el => el.innerHTML = '&#9650;');
            };

            const renderDriverPerformanceTable = (lapData, driverCode) => {
                document.getElementById('driver-lap-by-lap-title').textContent = `Lap-by-Lap Performance (${driverCode})`;
                const container = document.getElementById('driver-lap-by-lap-table');
                let tableHtml = `<table class="min-w-full divide-y divide-gray-200 text-sm">
                    <thead class="bg-gray-50"><tr>
                        <th class="px-4 py-2 text-left font-medium text-gray-500 uppercase">Lap</th>
                        <th class="px-4 py-2 text-left font-medium text-gray-500 uppercase">Position</th>
                        <th class="px-4 py-2 text-left font-medium text-gray-500 uppercase">Lap Time</th>
                        <th class="px-4 py-2 text-left font-medium text-gray-500 uppercase">Tyre</th>
                    </tr></thead><tbody class="bg-white divide-y divide-gray-200">`;
                
                lapData.forEach(lap => {
                    tableHtml += `<tr>
                        <td class="px-4 py-2">${lap.lap}</td>
                        <td class="px-4 py-2">${lap.position}</td>
                        <td class="px-4 py-2">${lap.time.toFixed(3)}</td>
                        <td class="px-4 py-2">${lap.compound}</td>
                    </tr>`;
                });

                tableHtml += `</tbody></table>`;
                container.innerHTML = tableHtml;
            };

            const renderComparisonChart = (driver1Corners, driver2Corners, driver1Code, driver2Code) => {
                const trace1 = {
                    x: driver1Corners.map(c => c.corner),
                    y: driver1Corners.map(c => c.speed),
                    name: driver1Code,
                    type: 'scatter',
                    mode: 'lines+markers'
                };
                const trace2 = {
                    x: driver2Corners.map(c => c.corner),
                    y: driver2Corners.map(c => c.speed),
                    name: driver2Code,
                    type: 'scatter',
                    mode: 'lines+markers'
                };

                const layout = {
                    xaxis: { title: 'Corner Number', gridcolor: '#e5e7eb' },
                    yaxis: { title: 'Speed (km/h)', gridcolor: '#e5e7eb' },
                    hovermode: 'x unified',
                    legend: { x: 0.5, xanchor: 'center', y: 1.1, orientation: 'h' },
                    margin: { t: 40, b: 40, l: 50, r: 20 },
                    paper_bgcolor: 'rgba(0,0,0,0)',
                    plot_bgcolor: 'rgba(0,0,0,0)'
                };

                Plotly.newPlot('corner-comparison-chart', [trace1, trace2], layout, {responsive: true});
            };

            const renderSchedule = (raceInfo) => { /* ... no change ... */ };
            const renderResults = (results) => { /* ... no change ... */ };

            const renderTelemetry = (telemetryData) => {
                document.getElementById('telemetry-title').innerHTML = `Fastest Lap Telemetry (${telemetryData.driver}) <span>&#9660;</span>`;
                const traces = [
                    { x: telemetryData.distance, y: telemetryData.speed, name: 'Speed (km/h)', yaxis: 'y1', type: 'scatter', line: {color: '#ef4444'} },
                    { x: telemetryData.distance, y: telemetryData.rpm, name: 'RPM', yaxis: 'y2', type: 'scatter', line: {color: '#3b82f6'} },
                    { x: telemetryData.distance, y: telemetryData.gear, name: 'Gear', yaxis: 'y3', type: 'scatter', mode: 'lines', line: {color: '#22c55e', shape: 'hv'} },
                    { x: telemetryData.distance, y: telemetryData.throttle, name: 'Throttle (%)', yaxis: 'y4', type: 'scatter', fill: 'tozeroy', line: {color: '#84cc16'} },
                    { x: telemetryData.distance, y: telemetryData.brake, name: 'Brake (%)', yaxis: 'y4', type: 'scatter', fill: 'tozeroy', line: {color: '#f97316'} }
                ];
                
                const layout = {
                    title: 'Full Lap Telemetry Data',
                    xaxis: { domain: [0.1, 0.9], title: 'Distance (m)' },
                    yaxis: { title: 'Speed', titlefont: {color: '#ef4444'}, tickfont: {color: '#ef4444'} },
                    yaxis2: { title: 'RPM', titlefont: {color: '#3b82f6'}, tickfont: {color: '#3b82f6'}, overlaying: 'y', side: 'right' },
                    yaxis3: { title: 'Gear', titlefont: {color: '#22c55e'}, tickfont: {color: '#22c55e'}, overlaying: 'y', side: 'right', position: 0.95, showgrid: false, range: [0, 9] },
                    yaxis4: { title: 'Input %', overlaying: 'y', side: 'left', position: 0.05, showgrid: false, range: [0, 105] },
                    hovermode: 'x unified',
                    legend: { x: 1.1, y: 1 },
                    paper_bgcolor: 'rgba(0,0,0,0)',
                    plot_bgcolor: 'rgba(0,0,0,0)',
                    grid: {rows: 1, columns: 1, pattern: 'independent'}
                };
                
                Plotly.newPlot('telemetry-chart', traces, layout, {responsive: true});
            };

            const renderLapTimes = (lapData, raceName) => {
                const plotData = Object.keys(lapData).map(driverId => ({
                    x: lapData[driverId].map(l => l.lap),
                    y: lapData[driverId].map(l => l.time),
                    mode: 'lines',
                    name: driverId
                }));
                const layout = {
                    title: `Lap Times for ${raceName}`,
                    xaxis: { title: 'Lap Number', gridcolor: '#e5e7eb' },
                    yaxis: { title: 'Lap Time (seconds)', gridcolor: '#e5e7eb' },
                    hovermode: 'x unified',
                    paper_bgcolor: 'rgba(0,0,0,0)',
                    plot_bgcolor: 'rgba(0,0,0,0)',
                };
                Plotly.newPlot('lap-times-chart', plotData, layout, {responsive: true});
            };
            
            const renderPitStops = (pitstops) => {
                const tableHead = document.querySelector('#pitstops-table thead');
                const tableBody = document.querySelector('#pitstops-table tbody');
                tableHead.innerHTML = `
                    <tr>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Driver</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Lap</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Stop No.</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Duration</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Tyre Compound</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Tyre Age (Laps)</th>
                    </tr>`;
                tableBody.innerHTML = pitstops.map(p => `
                    <tr class="bg-white hover:bg-gray-50">
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${p.driverId.toUpperCase()}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${p.lap}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${p.stop}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${p.duration}s</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${p.compound}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${p.tyreAge}</td>
                    </tr>`).join('');
            };

            function setupCollapsibles() {
                document.querySelectorAll('.collapsible').forEach(header => {
                    header.addEventListener('click', () => {
                        const content = header.nextElementSibling;
                        const arrow = header.querySelector('span');
                        if (content.style.display === "block") {
                            content.style.display = "none";
                            arrow.innerHTML = '&#9660;';
                        } else {
                            content.style.display = "block";
                            arrow.innerHTML = '&#9650;';
                        }
                    });
                });
            }

            // --- Unchanged Functions to be copied ---
            const originalRenderSchedule = (raceInfo) => {
                const scheduleDetails = document.getElementById('schedule-details');
                scheduleDetails.innerHTML = `
                    <p><strong>Race Name:</strong> ${raceInfo.raceName}</p>
                    <p><strong>Circuit:</strong> ${raceInfo.circuitName}</p>
                    <p><strong>Location:</strong> ${raceInfo.locality}, ${raceInfo.country}</p>
                    <p><strong>Date:</strong> ${raceInfo.date}</p>
                    <p><strong>Time:</strong> ${raceInfo.time || 'N/A'}</p>
                `;
            };

            const originalRenderResults = (results) => {
                const tableHead = document.querySelector('#results-table thead');
                const tableBody = document.querySelector('#results-table tbody');
                tableHead.innerHTML = `
                    <tr>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Pos</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Driver</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Team</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Laps</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Time</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Points</th>
                    </tr>`;
                tableBody.innerHTML = results.map(r => `
                    <tr class="bg-white hover:bg-gray-50">
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${r.position}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${r.Driver.givenName} ${r.Driver.familyName || ''} (${r.Driver.code})</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${r.Constructor.name}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${r.laps}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${r.Time ? r.Time.time : 'N/A'}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${r.status}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 font-bold">${r.points}</td>
                    </tr>`).join('');
            };

            // Replace the stubs in the main logic with these full functions
            renderSchedule = originalRenderSchedule;
            renderResults = originalRenderResults;

        });
    </script>

</body>
</html>
